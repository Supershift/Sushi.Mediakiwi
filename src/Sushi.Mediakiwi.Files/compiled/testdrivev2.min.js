function hookEventsForAccordionPanelForm(a){a.find(".datepicker").datepicker({changeMonth:!0,changeYear:!0}),a.find("textarea.rte").each(function(){var a=$(this).attr("id")+"_"+rteIndex;$(this).attr("id",a),rteIndex++,tinymce.execCommand("mceAddEditor",!0,a)}),a.find(".timepicker").timepicker({}),a.find('input[type="submit"]').click(function(){return!1}),a.find('input[type="submit"]').click(function(){return accordionDoPanelPostBack(a,$(this).attr("id")),!1}),a.find("#iconBarz a").click(function(){var b=$(this);if("#"==b.attr("href"))return accordionDoPanelPostBack(a,b.attr("id")),!1})}function accordionDoPanelPostBack(a,b){var c=a.parent().prev().data("accordion"),d=new FormData;d.append("autopostback",b);var e=a.find("#gridsection").find("input, select, button, textarea");e.prop("disabled",!0),e.each(function(a,b){var c=$(e[a]);"submit"==c.attr("type")||"radio"==c.attr("type")&&0==c[0].checked||null==c.attr("name")||(c.hasClass("rte")?d.append(c.attr("name"),tinyMCE.get(c.attr("id")).getContent()):d.append(c.attr("name"),c.val()))}),$.ajax({url:document.forms[0].action+"&openinframe=1&item="+c,dataType:"html",type:"POST",cache:!1,mimeType:"multipart/form-data",contentType:!1,processData:!1,data:d}).then(function(b){e.prop("disabled",!1),accordionBindResponsePanel(a,b,null)},function(){alert("click failed"),e.prop("disabled",!1)})}function accordionBindResponsePanel(a,b,c){var d=a.find("article");d.html("");var e=document.createElement("div");e.innerHTML=b,d.html($(e).find("#popupContent")),hookEventsForAccordionPanelForm(a),a.css("display","table-cell"),null!=c&&1==c&&(accordionOpened=a)}function handleAccordionClick(a,b){console.log("Click is accordion click");var c=$(a).parent("tr").next().find("td");c.is(":visible")?c.css("display","none"):(null!=accordionOpened&&accordionOpened.css("display","none"),$.ajax({url:document.forms[0].action+"&openinframe=1&item="+b,dataType:"html",type:"get"}).then(function(b){accordionBindResponsePanel(c,b,"true"==$(a).parent("tr").attr("data-accordionSinglePanelOpen"))},function(){alert("The list load of "+b+"couldn't be loaded")}))}function handleAccordionSelfClose(a){console.log("Self close"),$(a).parents("td").css("display","none"),accordionOpened=null}function SetClick(a){if(!(isNoClick||null!=$(a).attr("class")&&$(a).attr("class").indexOf("nopt")>-1)){var b=$(a).parent("tr").attr("data-accordion");if(null!=b&&b.length>0)return void handleAccordionClick(a,b);var c=!0,d=$(a).parent("tr").attr("id");if(null==d&&(d=$(a).attr("id"),c=!1),null!=d){var e="";if(d.indexOf("_")>-1&&d.indexOf("$")>-1){var f=d.split("_")[1].split("$"),g=$(a).parent("tr").attr("data-link");if(null!=g)e=g.indexOf("[KEY]")>-1?g.replace("[KEY]",f[1]):g.indexOf("&item=")>-1?g:!g.indexOf("&item")>-1?g+"="+f[1]:g;else{var h=getUrlVars().group,i=getUrlVars().folder;if(i=void 0!=i?"&folder="+i:"",void 0!=h){var j=getUrlVars().groupitem;e=document.URL.split("?")[0]+"?group="+h+i+"&groupitem="+j+"&item="+f[1]}else e=document.URL.split("?")[0]+"?item="+f[1]+i}}var k=null,l=null;if(c?(k=$(a).parent("tr").parent("tbody").attr("data-layer"),l=$(a).parent("tr").parent("tbody").attr("data-title")):k=$(a).attr("data-layer"),null!=k)return-1==e.indexOf("openinframe")&&(e.indexOf("?")>-1?e+="&openinframe=2":e+="?openinframe=2"),void mediakiwi.openLayer(e,$(a).parent("tr"),k,l);if(-1==e.indexOf("openinframe")){var m=getParam(location.href,"openinframe");null!=m&&(e+="&openinframe="+m)}location.href=e}var n=$(a).parent("tr").find("td:first").find("input:first");if(null!=n){var o=n.attr("id"),p=n.attr("value"),q=o+"|"+p;null!=d&&$(a).parent("tr").attr("class","parent selected");var r=getUrlVars().referid;if(null!=p&&null!=o&&null!=r){var s=r.substring(1,r.length)+"$"+o,t="#"+r,u=parent.$(t).attr("class").indexOf("single"),v=parent.$(t).attr("class").indexOf("newItemsOnTop");console.log("Add on top : "+v),u>-1?parent.$(t+" li").remove():$(a).parent("tr").hide("highlight",{},350,null),v>-1?parent.$(t).prepend('<li class="ui-state-default">'+p+'<figure class="icon-x del"> <input type="hidden" id="'+s+'" name="'+s+'" value="'+q+'" /> </li>'):parent.$(t).append('<li class="ui-state-default">'+p+'<figure class="icon-x del"> <input type="hidden" id="'+s+'" name="'+s+'" value="'+q+'" /> </li>'),u>-1&&parent.$.fn.colorbox.close();if(parent.$(t).attr("class").indexOf("postBack")>-1){if(parent.$(".async").length)return parent.postValue();parent.document.forms[0].submit()}}}}}function getUrl(a,b,c,d,e){a=a.split("#")[0];for(var f="",g=a.slice(a.indexOf("?")+1).split("&"),h=0;h<g.length;h++){var i=g[h].split("=");i[0]!=b&&(i[0]!=d&&(f+=(0==f.length?"?":"&")+i[0]+"="+i[1]))}return void 0==b?window.location.href.split("?")[0]+f:void 0==d?window.location.href.split("?")[0]+f+"&"+b+"="+c:window.location.href.split("?")[0]+f+"&"+b+"="+c+"&"+d+"="+e}function getParam(a,b){for(var c=a.slice(a.indexOf("?")+1).split("&"),d=0;d<c.length;d++)if(hash=c[d].split("="),hash[0]==b)return hash[1];return null}function getUrlVars(){for(var a,b=[],c=window.location.href.slice(window.location.href.indexOf("?")+1).split("&"),d=0;d<c.length;d++)a=c[d].split("="),b.push(a[0]),b[a[0]]=a[1];return b}function Switch(a){var b,c=$(a).attr("id"),d=c.split("_")[1].split("$")[1];$(".dataBlock table tbody tr").each(function(){if(b){var a="?list="+c.split("_")[1].split("$")[0]+"&sortF="+d+"&sortT="+$(this).attr("id").split("_")[1].split("$")[1];return $.get(a,function(a){}),!1}c==$(this).attr("id")&&(b=!0)})}function getParameters(a){var b,c,d={},e=$(a).attr("href").split("&");for(c=0;c<e.length;c++)b=e[c].split("="),d[b[0]]=b[1];return d}function toggleChecked(a){$(".dataBlock input").each(function(){$(this).attr("checked",a),$(this).parent("tr").addClass("active"),$(this).closest("tr").toggleClass("active",this.checked)})}function postValue(a){var b=!0;"export_xls"==$("#autopostback").val()&&$("#autopostback").val("");var c=$(document.forms[0]),d=c.serializeArray();if(null==a||"#"==a)a=b?"?AJAX=1&"+window.location.href.slice(window.location.href.indexOf("?")+1):"?split=homeArticle&"+window.location.href.slice(window.location.href.indexOf("?")+1);else{var e=getParam(a,"set");e>0&&(document.forms[0].action=getUrl(document.forms[0].action,"set",e))}$("div#loader").fadeIn("slow"),xhr&&4!=xhr.readystate&&xhr.abort(),xhr=$.post(a,d,function(a){return b?$("#datagrid").html(a):($("#homeArticle").html(a),mediakiwi.initRTE(),mediakiwi.initSourceCode()),mediakiwi.ASyncIsReady(),$("abbr").tipTip({maxWidth:"auto",edgeOffset:10}),$(".abbr").tipTip({maxWidth:"auto",edgeOffset:10}),!1}).always(function(){return $("div#loader").stop(),$("div#loader").fadeOut("fast"),!1})}function SelectPlanningInput(a){var b=parseFloat(a.val());if(isNaN(b)){var c=a.parents("td"),d=(parseFloat(c.data("planned")),parseFloat(c.data("available")));isNaN(d)&&(d=0),a.val(d)}a.css("background-color","#FFF"),a.css("border","1px solid #FFF"),a.css("color","#000")}function applyBackgroundColor(a,b){null!=b&&(b>=8?a.addClass("full"):b<=7&&b>0?a.addClass("half"):b>=0&&a.removeClass("half").removeClass("full"))}function postSingleValue(a,b,c,d){$.ajax({url:"?AJAX=1&"+window.location.href.slice(window.location.href.indexOf("?")+1),method:"POST",data:{value:a,user:b,task:d,date:c}})}function showLink(){var a=tinymce.activeEditor.dom,b=tinymce.activeEditor.selection.getNode(),c=a.getParent(b,"a[href]"),d=a.getAttrib(c,"href"),e="?list=161b60c4-75a6-4b54-a710-1e1691f738b4&openinframe=1&referid=tmce&notitle=1";if(0!=d&&0==d.indexOf("wim:")){e+="&item="+d.replace("wim:","")}$.colorbox({href:e,title:"Add link",iframe:!0,fixed:!0,width:"790px",height:"360px",transition:"elastic",scrolling:!1})}function insertLink(a){var b,c,d,e=tinymce.activeEditor;if(b=e.selection.getNode(),null==(b=e.dom.getParent(b,"A")))for(e.getDoc().execCommand("unlink",!1,null),tinymce.execCommand("mceInsertLink",!1,a,{skip_undo:1}),c=tinymce.grep(e.dom.select("a"),function(b){return e.dom.getAttrib(b,"href")==a}),d=0;d<c.length;d++)b=c[d],setLinkData(b,"href",a),tinymce.isMSIE5&&(b.outerHTML=b.outerHTML);else setLinkData(b,"href",a);1==b.childNodes.length&&"IMG"==b.firstChild.nodeName||(e.focus(),e.selection.select(b),e.selection.collapse(0)),tinymce.execCommand("mceEndUndoLevel"),$.colorbox.close()}function removeLink(){tinymce.execCommand("unlink",!1,null),$.colorbox.close()}function setLinkData(a,b,c){var d=tinymce.activeEditor.dom;void 0!==c&&null!=c||(c=""),"style"==b&&(c=d.serializeStyle(d.parseStyle(c),"a")),d.setAttrib(a,b,c)}var uri=null,isNoClick=!1,accordionOpened,rteIndex=0,xhr;$(document).on("click","input.async",function(){return postValue($(this).attr("href")),!1}),$(document).on("click","a.async",function(){return postValue($(this).attr("href")),!1}),$(function(){$("abbr").tipTip({maxWidth:"auto",edgeOffset:10}),$(".abbr").tipTip({maxWidth:"auto",edgeOffset:10})}),$(document).on("click",".postBack",function(){var a=$(this).get(0).tagName.toLowerCase(),b=$(this).get(0).type.toLowerCase();if("select"!=a&&"text"!=a&&("input"!=a||"submit"==b))return $("#autopostback").val($(this).attr("id")),$(this).get(0).className.indexOf("async")>-1?postValue():(document.forms[0].submit(),!1)});var mutePostbackEvent=0;$(document).on("change",".postBack",function(){if(mutePostbackEvent>0)return void mutePostbackEvent--;var a=$(this).get(0).tagName.toLowerCase();if("select"==a||"text"==a||"input"==a){if($("#autopostback").val($(this).attr("id")),$(".async").length&&-1==$(this).get(0).className.indexOf("nosync"))return postValue();document.forms[0].submit()}}),$(document).on("click",".dataBlock table td",function(){SetClick(this)}),$(document).on("click",".mk-dataitem",function(){SetClick(this)}),$(document).on("click","#inner input",function(){var a=$(this);SelectPlanningInput(a),a.select()}),$(document).on("focus","#inner input",function(){SelectPlanningInput($(this))}),$(document).on("blur","#inner input",function(){var a=$(this).parents("td"),b=parseFloat(a.data("planned")),c=parseFloat(a.data("available")),d=$(this).parent(),e=parseFloat($(this).val());isNaN(e)&&(e=booked),applyBackgroundColor(d,e),$(this).val(e.toFixed(2)),$(this).css("background-color","transparent"),$(this).css("border","1px solid transparent"),$(this).css("color","#fff");var f=$(this).prev("span");c-=parseFloat(e)-b;var g=Math.round(100*c)/100;g<=0?$("."+f.attr("class")).text(""):$("."+f.attr("class")).text(g);var h=$(".task_"+a.data("taskid")),i=parseFloat(h.first().text());i-=parseFloat(e)-b,h.each(function(){$(this).text(i.toFixed(2)),$(this).css("color",i<0?"red":"")}),postSingleValue(e,a.data("resource"),a.data("date"),a.data("taskid"))}),$(document).ready(function(){$(".cplan").each(function(){if(void 0!=$(this).data("date")){var a=$(this).data("date").substring(0,10),b=$(this).data("booked"),c=$(this).data("available");c="0"==c?"":c;var d=$(this).data("resource"),e=$(this).data("planned");""==e||e.toFixed(2);$(this).append('<div><span class="rs_'+d+"_"+a+'"  >'+c+'</span><input id="pl'+d+"."+a+'"   class="noSubmit prs_'+d+"_"+a+'"  type="text" maxlength="5" min="0" step="1" pattern="d+" /> <span>'+b+"</span></div>"),applyBackgroundColor($(this).find("div"),e),e>0&&$(this).find("input").val(e.toFixed(2))}})}),$(document).ready(function(){var a=0;$(".async").each(function(){if(0==a){a=1;var b=$(this).attr("data-link"),c=null;null!=b&&(c="?AJAX=1&"+b),postValue(c)}}),$(".numeric").numeric({negative:!1}),$(".uploadFile :file").bind("change",function(){var a=$(this).val().split("\\");$("#info_"+$(this).attr("id")).val(a[a.length-1])}),$(".autoupload").bind("change",function(){$("#autopostback").val("save"),document.forms[0].submit()}),$("#export").bind("change",function(){""!=$(this).val()&&($.colorbox({iframe:!0,transition:"none",width:"425px",opacity:"0.6",height:"226px",scrolling:!1,fixed:!0,href:"?list=161&openinframe=2&q="+getUrlVars().list}),$(this).val(""))}),$(".toggle").click(function(){$(".formfilters").slideToggle("fast")}),$(".hundred #toggle").addClass("arrowD"),$(".hundred #toggle").removeClass("arrowU"),$(".hundred #sideNav").hide(),$(".hundred #sideNav").css("z-index","0"),$("#toggle").bind("click",function(){var a=$("#sideNav");a.is(":hidden")?($("#homeArticle").animate({paddingLeft:"190px",zIndex:"1"},600,null,function(){$("#sideNav").css("z-index","10")}),$("#toggle").addClass("arrowU"),$("#toggle").removeClass("arrowD"),a.show()):($("#homeArticle").animate({paddingLeft:"40px",zIndex:"0"},600,null,function(){$("#sideNav").css("z-index","0")}),$("#toggle").addClass("arrowD"),$("#toggle").removeClass("arrowU"),a.hide())}),$("#ascrail2000").show(),$(".side").click(function(){$(this).next().hasClass("activeChannel")?$(this).next().removeClass("activeChannel").slideUp("fast"):($(".activeChannel").fadeToggle("fast").toggleClass("activeChannel"),$(this).next().fadeToggle("fast").toggleClass("activeChannel")),$("a.side").removeClass("active"),$(this).addClass("active")}),$(document).on("mousedown",function(a){0===$(a.target).closest(".activeChannel").length&&($(".activeChannel").hide(),$(".activeChannel").removeClass("activeChannel").slideUp("fast"))}),$(function(){$(".mail-1").toggle(function(){$(".inbox").stop().animate({left:"-=233"},400)},function(){$(".inbox").stop().animate({left:"+=233"},400)}),$(".user-1").toggle(function(){$(".metaMenu").stop().animate({left:"-=233"},400)},function(){$(".metaMenu").stop().animate({left:"+=233"},400)}),$(".magnifying-glass-1").toggle(function(){$(".searchFields").stop().animate({left:"-=233"},400)},function(){$(".searchFields").stop().animate({left:"+=233"},400)})}),navigator.userAgent.match(/Trident.*rv:11\./)&&$("body").addClass("ie11");var b=function(a,b,c){var d=new RegExp("([?&])"+b+"=.*?(&|#|$)","i");if(a.match(d))return a.replace(d,"$1"+b+"="+c+"$2");var e="";return-1!==a.indexOf("#")&&(e=a.replace(/.*#/,"#"),a=a.replace(/#.*/,"")),a+(-1!==a.indexOf("?")?"&":"?")+b+"="+c+e},c=function(a){console.log("posting to parent");var c=$(a).attr("id"),d=$(a).attr("value"),e=$(a).attr("data-multiple"),f=$(a).attr("data-editurl"),g=$(a).attr("data-listtitle"),h=$(a).attr("data-target"),i=$(a).attr("data-parentlevel"),j=window;i||(i=1);for(var k=0;k<i;k++)j=j.parent;void 0==h&&(h=getUrlVars().referid);var l=c+"|"+d;if(void 0!=h){console.log("Setting value to "+h);var m=h.substring(1,h.length)+"$"+c,n="#"+h,o=j.$(n).attr("class");if(void 0!=o){var p=o.indexOf("single")>-1,q=o.indexOf("newItemsOnTop");if(console.log("Add on top : "+q),"1"!=e&&p){var r=j.$(n).find(" > li > input").get(0),s=j.$(n).find(" > li > a").get(0);if(r&&($(r).attr("id",m),$(r).attr("name",m),$(r).attr("value",l)),s){$(s).html(d);var t=$(s).attr("href");!1===isNaN(c)&&$(s).attr("href",b(t,"item",c))}if(!r&&!s){var u='<li class="instant">';u+=f?'<a class="openlayer" data-layer="width:790px,height:450px,iframe:true,scrolling:false" title="'+g+'" href="'+f+'">'+d+"</a>":d,u+='<figure class="icon-x del"></figure> <input type="hidden" id="'+m+'" name="'+m+'" value="'+l+'" /> </li>',j.$(n).append(u)}}else q>-1?j.$(n).prepend('<li class="ui-state-default">'+d+'<figure class="icon-x del"> <input type="hidden" id="'+m+'" name="'+m+'" value="'+l+'" /> </li>'):j.$(n).append('<li class="ui-state-default">'+d+'<figure class="icon-x del"> <input type="hidden" id="'+m+'" name="'+m+'" value="'+l+'" /> </li>')}mediakiwi.closeLayer()}else console.log("No reference."),j.mediakiwi.closeLayer()};$(".postparentnow").live("click",function(){c(this)}),$(".postparent").each(function(){console.log("postparent 1"),c(this)}),$(".closeLayer").each(function(){mediakiwi.closeLayer()}),$(".postParent").each(function(){if(console.log("postparent 2"),mediakiwi.closeLayer(),parent.$(".async").length)return parent.postValue();var a=$(this).attr("data-url");void 0==a||""==a?parent.document.forms[0].submit():parent.document.location=a}),$(".post").click(function(){var a=$(this).get(0).tagName.toLowerCase(),b=$(this).get(0).type.toLowerCase();"select"==a||"text"==a||"input"==a&&"submit"!=b||$("#autopostback").val($(this).attr("id"))}),$(".post").change(function(){var a=$(this).get(0).tagName.toLowerCase();"select"!=a&&"text"!=a&&"input"!=a||$("#autopostback").val($(this).attr("id"))}),$(".ambiance").each(function(){$(this).hide(),$.ambiance({message:$(this).html(),timeout:5})}),$(".ui-tabs-nav").find(".ui-tabs-selected"),$(".datepicker").datepicker({changeMonth:!0,changeYear:!0}),$(".timepicker").timepicker({}),$("tr.parent").hover(function(){var a=$(this),b=a.find("a.open"),c=a.siblings(".child-"+this.id);b.css("cursor","pointer").attr("title","Click to expand/collapse"),b.click(function(){c.toggle(),c.toggleClass("activeSub"),a.toggleClass("active"),b.toggleClass("close")})}),$("tr[class^=child]").hide().children("td"),$(".checkbox").change(function(){$(this).closest("tr").toggleClass("active",this.checked)}),$("input[type=text]").keypress(function(a){if(13==a.which){if($(this).hasClass("noSubmit")||"FilterTitle"==a.target.id)return $(this).blur(),!1;if($(".async").length)return postValue(),!1;document.forms[0].submit()}}),$(".connectedSortable").sortable({connectWith:".connectedSortable",placeholder:"ui-state-highlight"}).disableSelection(),$(".multiSortable li figure.del").live("click",function(){var a=$(this).parent();a.clone();a.remove()}),$(".simpleSortDown").live("click",function(){var a=$(this).parents(".cmsable"),b=a.next();return null==b&&null==b[0]||(a.find("textarea.rte").each(function(){tinymce.execCommand("mceRemoveEditor",!1,$(this).attr("id"))}),a.detach(),a.insertAfter(b),a.find("textarea.rte").each(function(){tinymce.execCommand("mceAddEditor",!0,$(this).attr("id"))})),!1}),$(".simpleSortUp").live("click",function(){var a=$(this).parents(".cmsable"),b=a.prev();return null==b&&null==b[0]||(a.find("textarea.rte").each(function(){tinymce.execCommand("mceRemoveEditor",!1,$(this).attr("id"))}),a.detach(),a.insertBefore(b),a.find("textarea.rte").each(function(){tinymce.execCommand("mceAddEditor",!0,$(this).attr("id"))})),!1});var d=!1;$(document).on("click",".sortOrder",function(){if($(this).attr("class").indexOf("icon-sort")>-1){if(d)$(".dataBlock table tbody").sortable("enable");else{var a=0;$(".dataBlock table tbody").sortable({placeholder:"ui-state-highlight",items:"tr:not(.nosort)",cancel:".nosort",start:function(b,c){$.browser.webkit&&(a=$(window).scrollTop())},sort:function(b,c){$.browser.webkit&&c.helper.css({top:c.position.top+a+"px"})},update:function(a,b){Switch(b.item)}}).disableSelection(),d=!0}$(this).attr("class",$(this).attr("class").replace("icon-sort","icon-list2")),$(".dataBlock table td").off("click"),$.ambiance({message:"Sorting is enabled."})}else $(".dataBlock table tbody").sortable("disable"),$(this).attr("class",$(this).attr("class").replace("icon-list2","icon-sort")),$(".dataBlock table td").click(function(){SetClick(this)}),$.ambiance({message:"Sorting is disabled."});return!1})});var mediakiwi=mediakiwi||{};$(function(){$(document).ready(function(){$(".inner").niceScroll({cursorcolor:"#a3acb4",cursoropacitymin:.3,cursorborder:"0",cursorwidth:10,boxzoom:!1,autohidemode:!1,cursorminheight:30,cursorwidth:10}),void 0!=mediakiwi.GridScrollbar&&$(".inner").getNiceScroll(mediakiwi.GridScrollbar.index).doScrollLeft(mediakiwi.GridScrollbar.x,1),$("td abbr").shorten(),$("th abbr").shorten()})}),mediakiwi.moveGridScrollbarX=function(a,b){mediakiwi.GridScrollbar=new Object,mediakiwi.GridScrollbar.x=a,mediakiwi.GridScrollbar.index=b},mediakiwi.async=[],mediakiwi.registerASyncReadyCallBack=function(a,b){this.async[a]=b},mediakiwi.ASyncIsReady=function(){for(var a in this.async)this.async[a]()},mediakiwi.collection=[],mediakiwi.registerJsonCallBack=function(a,b){this.collection[a]=b},mediakiwi.callBack=function(a,b,c){void 0!=this.collection[a]&&this.collection[a](b,c)},mediakiwi.registerJsonCallBack("foo",function(a,b){alert("bar"),console.log(b)}),mediakiwi.openLayer=function(a,b,c,d,e){void 0==a&&(a=b.attr("data-link")),void 0==d&&(d=b.attr("data-title"));var f=[];void 0==c&&(c=b.attr("data-layer")),void 0!=c&&jQuery.each(c.split(","),function(a,b){var c=b.split(":");f[c[0]]=c[1]}),void 0!=f.class?$("#colorbox").removeClass().addClass(f.class):$("#colorbox").removeClass();var g=void 0==f.iframe||"true"==f.iframe;$.colorbox({href:a,html:e,title:d,iframe:g,fixed:void 0==f.fixed||"true"==f.fixed,width:void 0==f.width?"790px":f.width,height:f.height,transition:"none",scrolling:void 0==f.scrolling||"true"==f.scrolling})},mediakiwi.pageComponentControl=mediakiwi.pageComponentControl||{},mediakiwi.pageComponentControl.animationSpeed=600,mediakiwi.pageComponentControl.moveComponentUp=function(a,b){var c=$(a).parents(".OrderingField"),d=c.prev();return null!=d.find(".isSortable")[0]&&(c.find("textarea.rte").each(function(){tinymce.execCommand("mceRemoveEditor",!1,$(this).attr("id"))}),c.detach(),c.insertBefore(d),c.find("textarea.rte").each(function(){tinymce.execCommand("mceAddEditor",!0,$(this).attr("id"))})),!1},mediakiwi.pageComponentControl.moveComponentDown=function(a,b){var c=$(a).parents(".OrderingField"),d=c.next();return null!=d.find(".isSortable")[0]&&(c.find("textarea.rte").each(function(){tinymce.execCommand("mceRemoveEditor",!1,$(this).attr("id"))}),c.detach(),c.insertAfter(d),c.find("textarea.rte").each(function(){tinymce.execCommand("mceAddEditor",!0,$(this).attr("id"))})),!1},mediakiwi.pageComponentControl.moveComponentDelete=function(a,b,c,d){if(confirm("Please confirm that the '"+c+"' may be deleted.")){if($(a).parents(".OrderingField").remove(),void 0!=mediakiwi.pageComponentControl.options){var e=mediakiwi.pageComponentControl.options[d];void 0!=e&&e.indexOf('removeAfterUse="1"')>0&&$("#cms > div > div > a:last-child").after(e)}}return!1},mediakiwi.pageComponentControl.showOptions=function(){return $("#addPageComponentControlItems").find(".cmsBlocks a").hide(),$("#addPageComponentControlItems").show().width("0%").animate({width:"100%"},mediakiwi.pageComponentControl.animationSpeed,function(){$("#addPageComponentControlItems").find(".cmsBlocks a").show()}),$("#addPageComponentControlAdder").hide(),!1},mediakiwi.pageComponentControl.closeOptions=function(){return $("#addPageComponentControlItems").find(".cmsBlocks a").hide(),$("#addPageComponentControlItems").animate({width:"0%"},mediakiwi.pageComponentControl.animationSpeed,function(){$(this).hide(),$("#addPageComponentControlAdder").show()}),!1},mediakiwi.pageComponentControl.addItemToPage=function(a,b,c,d){var e=$(a);return $.ajax({url:getUrl(document.forms[0].action,"xml","component")+"&id="+b+"&cmpt="+d,dataType:"json",type:"POST",error:function(a){if(200==a.status){$("#cms").before(a.responseText);$("#cms").prev().find("textarea.rte").each(function(){tinymce.execCommand("mceAddEditor",!0,$(this).attr("id"))}),"1"==e.attr("removeafteruse")&&e.remove()}}}),!1},$(document).bind("cbox_complete",function(){$(".abbr").tipTip({maxWidth:"auto",edgeOffset:10})}),mediakiwi.closeLayer=function(){parent.$.fn.colorbox.close()},mediakiwi.initRTE=function(){tinymce.init({selector:"textarea.rte",plugins:["autolink autosave lists","visualblocks code nonbreaking","autoresize link"],browser_spellcheck:!0,toolbar:"bold italic underline bullist numlist indent outdent | link unlink removeformat subscript superscript code",statusbar:!1,table_cell_advtab:!1,table_appearance_options:!1,forced_root_block:!1,menubar:!1,toolbar_items_size:"small"}),tinymce.init({selector:"textarea.table_rte",plugins:["autolink autosave lists","visualblocks code nonbreaking","autoresize link  table contextmenu"],browser_spellcheck:!0,toolbar:"bold italic underline bullist numlist indent outdent | link unlink removeformat subscript superscript code table",statusbar:!1,table_cell_advtab:!1,table_appearance_options:!1,forced_root_block:!1,menubar:!1,toolbar_items_size:"small"}),tinymce.init({selector:"textarea.fixed_rte",plugins:["autolink autosave lists","visualblocks code nonbreaking","link"],browser_spellcheck:!0,toolbar1:"bold italic underline bullist numlist indent outdent | link unlink removeformat subscript superscript code",statusbar:!1,forced_root_block:!1,menubar:!1,toolbar_items_size:"small"})},mediakiwi.initSourceCode=function(a){void 0==a&&(a=""),a.length>0&&(a+=" "),$(a+".SourceCode").each(function(b,c){function d(a){return void 0==a||/^</.test(a)}function e(){g.setOption("mode",d(g.getValue())?"htmlmixed":"clike")}if(void 0==$(c).attr("data-done")||""==a){$(c).attr("data-done","1");var f,g=CodeMirror.fromTextArea(c,{wordwrapping:!0,autoCloseTags:!0,lineNumbers:!0,fixedGutter:!0,lineWrapping:!0,readOnly:!($(this).attr("class").indexOf("editable")>-1),extraKeys:{Esc:function(a){a.setOption("fullScreen",!a.getOption("fullScreen"))}}});g.on("change",function(){clearTimeout(f),f=setTimeout(e,400)}),g&&e()}})},mediakiwi.multifileUpload=function(){$(".multiBox").each(function(a,b){function c(){f.userCancel=!1;var a="";$(f.files).each(function(b,c){a+='<li><span>#filename#</span> - <span>#size#</span><br/><progress id="#index#" max="100"  value="0"></progress></li>'.replace(/#filename#/g,c.name).replace(/#size#/g,e(c.size)).replace(/#index#/g,b)}),i.html(a),$(f.files).each(function(a,b){b.done=!1;var c=new FormData;c.append("file",b);var d=$.ajax({url:"multifileupload.ashx?gallery="+h.attr("galleryGUID")+"&source="+n.attr("id"),data:c,cache:!1,contentType:!1,processData:!1,type:"POST",xhr:function(){var b=new window.XMLHttpRequest;return b.upload.addEventListener("progress",function(b){if(b.lengthComputable){var c=Math.round(b.loaded/b.total*100),d=i.find("#"+a);console.log(c),d.attr("value",c)}},!1),b}}).success(function(c){n.val(n.val()+","+c.toString()),i.find("#"+a).attr("value",100),b.done=!0;var d=!1;for(var e in f.files)0==f.files[e].done&&(d=!0);0==d&&(l.hide(),m.html("All files have been uploaded"),f.currentXHRs=[])}).fail(function(){0==f.userCancel&&(i.find("#"+a).hide(),m.html("One or more files were not transfered."))});f.currentXHRs.push(d)})}function d(){var a="";$(f.files).each(function(b,c){a+='<li><span>#filename#</span> - <span>#size#</span><span  class="remove"><a href="#" data-file="#filename#">Remove</a></span></li>'.replace(/#filename#/g,c.name).replace(/#size#/g,e(c.size))}),i.html(a),i.find(".remove a").on("click",function(){var a=$(this).data("file");f.files=$.grep(f.files,function(b){return b.name!=a}),d()})}function e(a){return a<1e3?a+" bytes":a<1e6?Math.round(a/1e3)+" KB":a<1e9?Math.round(a/1e6)+" MB":Math.round(a/1e9)+" GB"}var f=$(b);f.files=[],f.currentXHRs=[],f.userCancel=!1,f.uploading=!1;var g=f.find(".multiAssetUpload_Button"),h=f.find('input[type="file"]'),i=f.find(".multiAssetUpload_resultFiles"),j=f.find(".clearButton"),k=f.find(".uploadButton"),l=f.find(".cancelButton"),m=f.find(".message"),n=f.find(".resultCollection");l.hide(),i.html(""),f.on("dragover",function(a){a.preventDefault(),a.stopPropagation(),0==f.uploading&&f.addClass("dropTarget")}),f.on("dragleave",function(a){a.preventDefault(),a.stopPropagation(),0==f.uploading&&f.removeClass("dropTarget")}),f.on("drop",function(a){if(0==f.uploading){a.preventDefault(),a.stopPropagation();var b=a.originalEvent.dataTransfer.files;$.merge(f.files,b),f.removeClass("dropTarget"),d()}return!1}),g.on("click",function(){h.click()}),h.on("change",function(a){var b=$(a.target),c=$.makeArray(b.prop("files"));$.merge(f.files,c),d()}),l.on("click",function(a){f.userCancel=!0;for(var b in f.currentXHRs)f.currentXHRs[b].abort();return m.html("Transfers have been canceled"),g.show(),j.show(),k.show(),l.hide(),d(),!1}),j.on("click",function(a){return f.files.length>0&&confirm("Are you sure you want to clear the list?")&&(f.files=[],d()),!1}),k.on("click",function(a){return f.files.length>0?(f.uploading=!0,g.hide(),j.hide(),k.hide(),l.show(),c()):alert("Please add 1 or more items to the collection"),!1})})},$(function(){$(document).ready(function(){mediakiwi.initRTE(),mediakiwi.multifileUpload(),$(document).on("click",".cmsable .closer",function(){var a=$(this),b=a.parent("h3").parent("div"),c=b.find("textarea.rte");return c&&tinymce.execCommand("mceRemoveEditor",!1,$(c).attr("id")),b.remove(),!1}),$(document).on("click",".addContentType",function(){var a=$(this),b=a.attr("data-type"),c=a.parent("div").parent("div"),d=c.attr("data-width"),e=c.attr("data-gallery"),f=c.attr("data-name");void 0==this.count?this.count=parseInt(c.attr("data-count"))+1:this.count++;var g=document.URL.replace("#","")+"&xml="+b+"&id="+f+"&index="+this.count+"&w="+d+"&gallery="+e;return $.ajax({type:"GET",url:g,dataType:"html",success:function(a){c.parent("td").find(".multitarget").append(a),mediakiwi.initRTE(),mediakiwi.initSourceCode(".multitarget")}}),!1}),$.extend($.expr[":"],{containsi:function(a,b,c,d){return(a.textContent||a.innerText||"").toLowerCase().indexOf((c[3]||"").toLowerCase())>=0}}),$("#FilterTitle,.searchFilter").on("keyup",function(){var a=$(this).parents("article").find("#startWidgets"),b=$(this).val();a.find("div>a:not(:containsi('"+b+"'))").hide();var c=a.find("div>a:containsi('"+b+"')");c.show(),a.find(".widget").hide(),c.parent().show()}),$("input[type=checkbox].checkall").bind("click",function(){var a=$(this).parents("th"),b=a[0].cellIndex+1;a.parents("table").find("tr>td:nth-child("+b+") input").click()}),$(".openlayerauto").each(function(){var a=$(this),b=a.attr("href");return void 0==b&&(b=a.attr("data-url")),mediakiwi.openLayer(b,a,a.attr("data-layer"),a.attr("title")),!1}),$(document).on("click",".click",function(){var a=$(this),b=a.attr("href");return void 0==b&&(b=a.attr("data-link")),location.href=b,!1}),$(document).on("click",".openlayer",function(){var a=$(this);return window.parent.location!=window.location&&(parent.$.fn.colorbox.resize({width:"870px",height:"90%"}),$(document).bind("cbox_cleanup",function(){parent.$.fn.colorbox.resize({width:"790px",height:"90%"})})),mediakiwi.openLayer(a.attr("href"),a,a.attr("data-layer"),a.attr("data-title")),!1}),$(document).on("click",".closelayer",function(){return mediakiwi.closeLayer(),!1}),$(document).on("click",".confirm",function(){return $(this).get(0).className.indexOf("async")>-1?postValue():(document.forms[0].submit(),!1)}),$(".type_confirm").click(function(){var a=$(this);$("#autopostback").val($(this).attr("id"));var b=a.attr("data-confirm"),c=a.attr("data-confirm-title"),d=a.attr("data-confirm-n"),e=a.attr("data-confirm-y"),f=a.get(0).className.indexOf("async")>-1?" async":"",g='<section id="popupContent"><p style="min-height: 60px;">'+b+"</p>";return void 0!=e&&(g+='<input type="submit" id="submit" name="submit" value="'+e+'" class="submit action right confirm'+f+'" />'),void 0!=d&&(g+='<input type="submit" id="cancel" name="cancel" value="'+d+'" class="submit right closelayer'+f+'" />'),g+="</section>",mediakiwi.openLayer(null,a,"width:400px,height:200px,scrolling:true,iframe:false",c,g),!1}),$(".Small").click(function(){var a=$(this),b=a.attr("data-height");return void 0==b&&(b="414"),mediakiwi.openLayer(a.attr("href"),a,"width:790px,height:"+b+"px,scrolling:true,iframe:true",a.attr("title")),!1}),$(".Normal").click(function(){var a=$(this);return mediakiwi.openLayer(a.attr("href"),a,"width:790px,height:90%,scrolling:true,iframe:true",a.attr("title")),!1}),$(".Tiny").click(function(){var a=$(this),b=a.attr("data-height");return void 0==b&&(b="314"),mediakiwi.openLayer(a.attr("href"),a,"width:472px,height:"+b+"px,scrolling:false,iframe:true",a.attr("title")),!1}),$(".atext").each(function(){}).on("change",function(a){var b=$(this),c=$("form").serialize()+"&async_query="+b.val()+"&async="+b.attr("id");$.ajax({type:"POST",url:getUrl(document.forms[0].action,"json","1"),data:c,dataType:"json",success:function(a){b.Data=a,void 0!=b.Data.Reset&&jQuery.each(b.Reset,function(a,b){var c=$("#"+b);c.val(""),c.select2("data",{id:null,text:null})}),void 0!=b.Data.CallBack&&mediakiwi.callBack(b.Data.CallBack,b.val(),b.Data)}})}),$("select.styled").each(function(){var a=$(this),b=a.attr("data-max");a.select2({allowClear:!0,placeholder:"",maximumSelectionLength:b,escapeMarkup:function(a){return a}}).on("change",function(a){var b=$(this).attr("data-reset")
;void 0!=b&&jQuery.each(b.split(","),function(a,b){var c=$("#"+b);c.prop("cacheDataSource",[]),c.val(""),c.select2("data",{id:null,text:null})})})}),$(".aselect").each(function(){var a=$(this),b=this,c=a.attr("data-ph");void 0==c&&(c=" ");var d,e=(a.attr("id"),getUrl(document.forms[0].action,"json","1"));a.select2({ajax:{language:"nl",url:e,dataType:"json",data:function(b){for(var c=($("form").serialize(),{async:a.attr("id"),async_query:null!=b.term?b.term.toLowerCase():""}),d=$("form").serialize().split("&"),e=0;e<d.length;e++){var f=d[e],g=f.split("=");c[g[0]]=g[1]}return c},processResults:function(b,c){void 0!=b.Reset?a.Reset=b.Reset:a.Reset=null;var d=[];for(var e in b.Result){var f=b.Result[e];d.push({id:f.Value,text:f.Text})}return{results:d}},cache:!1},placeholder:c,allowClear:!0,minimumInputLength:a.attr("data-len"),formatNoMatches:function(){return"Geen resultaten gevonden"},formatInputTooShort:function(a,b){var c=b-a.length;return"Vul nog "+c+" karakter"+(1==c?"":"s")+" in"},formatInputTooLong:function(a,b){var c=a.length-b;return"Haal "+c+" karakter"+(1==c?"":"s")+" weg"},formatSelectionTooBig:function(a){return"Maximaal "+a+" item"+(1==a?"":"s")+" toegestaan"},formatLoadMore:function(a){return"Meer resultaten laden…"},formatSearching:function(){return"Zoeken…"},escapeMarkup:function(a){return a}}).on("change",function(b){if(null!=a.Reset&&jQuery.each(a.Reset,function(a,b){var c=$("#"+b);mutePostbackEvent+=1,c.val(null).trigger("change")}),null!=a.Data&&(void 0!=a.Data.CallBack&&mediakiwi.callBack(a.Data.CallBack,value,a.Data),a.Data.OnSelectCallBack)){var c=$("form").serialize()+"&async_rid="+b.val+"&async="+a.attr("id");d=$.ajax({type:"POST",url:getUrl(document.forms[0].action,"json","1"),data:c,dataType:"json",success:function(a){void 0!=a.CallBack&&mediakiwi.callBack(a.CallBack,b.val,a)}})}}),b.cacheDataSource=[]})})});